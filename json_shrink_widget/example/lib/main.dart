import 'package:extended_image/extended_image.dart';
import 'package:flutter/material.dart';
import 'package:json_shrink_widget/json_shrink_widget.dart';

void main() async {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: const MyHomePage(title: 'JsonViewer'),
    );
  }
}

class MyHomePage extends StatefulWidget {
  const MyHomePage({Key? key, required this.title}) : super(key: key);
  final String title;

  @override
  State<MyHomePage> createState() => _MyHomePageState();
}

const _json =
    '{"runTime":0,"code":200,"msg":"Success","msg_display":1,"api_info":{"Location":"kh","ip":"96.9.67.134"},"data":{"rule_info":{"registered_country":"us","region_id":6},"errors":[],"data":[{"title":"Carousel","type":"carousel","contents":[{"id":90,"created_at":"2022-04-02 07:45:52","updated_at":"2022-04-02 07:45:52","publicity_link":"https://www.youtube.com/?type=99","publicity_introduction":"123123","publicity_link_type":"3","publicity_show":"2","publicity_title":"7777","publicity_cfg":{"km":"XXXX@!#","th":"XXXXX","zh":"SSSSS"},"publicity_sort":12,"app_channel_id":10001,"image_url":"https://image.super-server.co/dev//PublicityCarousel/development/683df385e9580b24f733478fa4da3fa3.png?v=6f236a8e499aafe4b0b05ac4907c947d","publicity_link_type_text":"App:WebLink","publicity_show_text":"display:show","publicity_app_type":"99"},{"id":89,"created_at":"2022-04-02 07:43:40","updated_at":"2022-04-02 07:43:40","publicity_link":"www.youtube.com?type=99","publicity_introduction":"hh","publicity_link_type":"3","publicity_show":"2","publicity_title":"aa","publicity_cfg":{"km":"XXXX@!#","th":"XXXXX","zh":"SSSSS"},"publicity_sort":10,"app_channel_id":10001,"image_url":"https://image.super-server.co/dev//PublicityCarousel/development/689d9d527cc765bb0e09f000aabe7978.png?v=6f236a8e499aafe4b0b05ac4907c947d","publicity_link_type_text":"App:WebLink","publicity_show_text":"display:show","publicity_app_type":"99"},{"id":77,"created_at":"2022-03-25 04:28:45","updated_at":"2022-03-25 04:28:45","publicity_link":"http://localhost/?type=2&id=576621","publicity_introduction":"新歌手","publicity_link_type":"3","publicity_show":"2","publicity_title":"justin bieber","publicity_cfg":{"km":"XXXX@!#","th":"XXXXX","zh":"SSSSS"},"publicity_sort":3,"app_channel_id":10001,"image_url":"https://image.super-server.co/dev//PublicityCarousel/development/2cca6137ee62f6876fdb72d1d426ddb0.png?v=6f236a8e499aafe4b0b05ac4907c947d","publicity_link_type_text":"App:Singer","publicity_show_text":"display:show","publicity_app_type":"2"},{"id":76,"created_at":"2022-03-25 04:27:26","updated_at":"2022-03-25 04:27:26","publicity_link":"http://localhost/?type=1&id=577812","publicity_introduction":"新專輯跑馬","publicity_link_type":"3","publicity_show":"2","publicity_title":"Ed Sheeran - =","publicity_cfg":{"km":"XXXX@!#","th":"XXXXX","zh":"SSSSS"},"publicity_sort":2,"app_channel_id":10001,"image_url":"https://image.super-server.co/dev//PublicityCarousel/development/683df385e9580b24f733478fa4da3fa3.png?v=6f236a8e499aafe4b0b05ac4907c947d","publicity_link_type_text":"App:Album","publicity_show_text":"display:show","publicity_app_type":"1"},{"id":75,"created_at":"2022-03-25 04:12:29","updated_at":"2022-03-25 04:12:29","publicity_link":"http://localhost/?type=0&id=3201799","publicity_introduction":"新歌跑馬1","publicity_link_type":"3","publicity_show":"2","publicity_title":"Adele-To Be Loved","publicity_cfg":{"km":"XXXX@!#","th":"XXXXX","zh":"SSSSS"},"publicity_sort":1,"app_channel_id":10001,"image_url":"https://image.super-server.co/dev//PublicityCarousel/development/689d9d527cc765bb0e09f000aabe7978.png?v=6f236a8e499aafe4b0b05ac4907c947d","publicity_link_type_text":"App:Song","publicity_show_text":"display:show","publicity_app_type":"0"},{"id":79,"created_at":"2022-03-25 04:36:17","updated_at":"2022-03-25 04:36:17","publicity_link":"https://webdev.shamumusic.com/artist/535764?type=99","publicity_introduction":"singer link","publicity_link_type":"3","publicity_show":"2","publicity_title":"Glass Animals display app","publicity_cfg":{"km":"XXXX@!#","th":"XXXXX","zh":"SSSSS"},"publicity_sort":1,"app_channel_id":10001,"image_url":"https://image.super-server.co/dev//PublicityCarousel/development/ece75f39cba5fac1678299233b47ba95.png?v=6f236a8e499aafe4b0b05ac4907c947d","publicity_link_type_text":"App:WebLink","publicity_show_text":"display:show","publicity_app_type":"99"}]},{"title":"News Song","type":"news","contents":[{"music_num":3201787,"music_name":"Equal in the Darkness (Steve Aoki Character X Version)","audioUrl":"https://image.super-mmo2.co/dev/m4a/517733/566710/3201787/NTE3NzMzLzU2NjcxMC8zMjAxNzg3.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"Steve Aoki","singer_num":517733,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/517733/0//10d5040859b00ae346fb5b67fe94e09a_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","album_num":566710,"album_name":"Equal in the Darkness (Steve Aoki Character X Version)","album_image":"https://image.super-server.co/dev/images/albums/development/a42c1594763cad0d0ad7cce604170c34/566710/517733//62c42d35684d16de5f3789c53dfd75d6_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d"},{"music_num":3000015,"music_name":"一生中最愛","audioUrl":"https://image.super-mmo2.co/dev/m4a/500018/500020/3000015/NTAwMDE4LzUwMDAyMC8zMDAwMDE1.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"譚詠麟","singer_num":500018,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34//a1cbe9f1665fd73d7fe5300e0587a17d_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","album_num":500020,"album_name":"藝能25週年","album_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34//a1cbe9f1665fd73d7fe5300e0587a17d_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d"},{"music_num":3000010,"music_name":"正式開始","audioUrl":"https://image.super-mmo2.co/dev/m4a/500010/500014/3000010/NTAwMDEwLzUwMDAxNC8zMDAwMDEw.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"Ian 陳卓賢","singer_num":500010,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/500010/0//ef08aa9d2c29160f2b2c924e056bd8db_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","album_num":500014,"album_name":"正式開始","album_image":"https://image.super-server.co/dev/images/albums/development/a42c1594763cad0d0ad7cce604170c34/500014/500010//46898aec1d9bc3df1b99046cecbd70a8_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d"},{"music_num":3181979,"music_name":"Equal in the Darkness","audioUrl":"https://image.super-mmo2.co/dev/m4a/517733/555086/3181979/NTE3NzMzLzU1NTA4Ni8zMTgxOTc5.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"Steve Aoki","singer_num":517733,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/517733/0//10d5040859b00ae346fb5b67fe94e09a_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","album_num":555086,"album_name":"Equal in the Darkness","album_image":"https://image.super-server.co/dev/images/albums/development/a42c1594763cad0d0ad7cce604170c34/555086/517733//0e60068b0189d3ab99c1a7482b203f22_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d"},{"music_num":3181980,"music_name":"Equal in the Darkness","audioUrl":"https://image.super-mmo2.co/dev/m4a/514434/555087/3181980/NTE0NDM0LzU1NTA4Ny8zMTgxOTgw.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"蔡依林","singer_num":514434,"singer_image":"https://placeimg.com/500/500/tree","album_num":555087,"album_name":"Equal in the Darkness","album_image":"https://picsum.photos/500/500"},{"music_num":3181982,"music_name":"Equal in the Darkness","audioUrl":"https://image.super-mmo2.co/dev/m4a/555089/555090/3181982/NTU1MDg5LzU1NTA5MC8zMTgxOTgy.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"Max","singer_num":555089,"singer_image":"https://placeimg.com/500/500/tree","album_num":555090,"album_name":"Equal in the Darkness","album_image":"https://placeimg.com/500/500/tree"},{"music_num":3184638,"music_name":"例Test-Equal in the Darkness","audioUrl":"https://image.super-mmo2.co/dev/m4a/556930/556931/3184638/NTU2OTMwLzU1NjkzMS8zMTg0NjM4.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"例Test-Steve Aoki","singer_num":556930,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/556930///6cc6a6c3576361873d818193c02e8e34_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","album_num":556931,"album_name":"例Test-Equal in the Darkness","album_image":"https://image.super-server.co/dev/images/albums/development/a42c1594763cad0d0ad7cce604170c34/556931/556930//440ebe8f69a964769d0f7c5ab7efab44_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d"},{"music_num":3184639,"music_name":"例Test-例Test-Equal in the Darkness","audioUrl":"https://image.super-mmo2.co/dev/m4a/556932/556933/3184639/NTU2OTMyLzU1NjkzMy8zMTg0NjM5.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"例Test-蔡依林","singer_num":556932,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/556932///cf16736267b223f8a326073cbe54bd5d_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","album_num":556933,"album_name":"例Test-例Test-Equal in the Darkness","album_image":"https://image.super-server.co/dev/images/albums/development/a42c1594763cad0d0ad7cce604170c34/556933/556932//a7858c18d744b9e4e8c498a332c643f6_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d"},{"music_num":3184640,"music_name":"例Test-例Test-例Test-Equal in the Darkness","audioUrl":"https://image.super-mmo2.co/dev/m4a/556934/556935/3184640/NTU2OTM0LzU1NjkzNS8zMTg0NjQw.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"例Test-Max","singer_num":556934,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/556934///f1e6cd69d27d4e51761dea90a161ba4d_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","album_num":556935,"album_name":"例Test-例Test-例Test-Equal in the Darkness","album_image":"https://image.super-server.co/dev/images/albums/development/a42c1594763cad0d0ad7cce604170c34/556935/556934//55338b929289af36931cf84aaf6f281c_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d"},{"music_num":3201520,"music_name":"都沒差 (Equal in the Darkness)","audioUrl":"https://image.super-mmo2.co/dev/m4a/517733/555086/3201520/NTE3NzMzLzU1NTA4Ni8zMjAxNTIw.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"Steve Aoki","singer_num":517733,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/517733/0//10d5040859b00ae346fb5b67fe94e09a_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","album_num":555086,"album_name":"Equal in the Darkness","album_image":"https://image.super-server.co/dev/images/albums/development/a42c1594763cad0d0ad7cce604170c34/555086/517733//0e60068b0189d3ab99c1a7482b203f22_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d"},{"music_num":3212059,"music_name":"Equal in the Darkness","audioUrl":"https://image.super-mmo2.co/dev/m4a/577262/579625/3212059/NTc3MjYyLzU3OTYyNS8zMjEyMDU5.m4a?v=6f236a8e499aafe4b0b05ac4907c947d","videoUrl":"","singerName":"蔡依林","singer_num":577262,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/577262/0//0836fe4db1c1e00257bad3223c937a1d_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","album_num":579625,"album_name":"Equal in the Darkness","album_image":"https://image.super-server.co/dev/images/albums/development/a42c1594763cad0d0ad7cce604170c34/579625/577262//7650770b31423d8e331758b908952b20_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d"}]},{"title":"Directory","type":"app_main_directory","contents":[{"id":23,"title":"New Releases 2022","update_by":null,"created_by":null,"status_text":"online","get_app_main_page_lists":[{"id":46,"created_time":"2022-03-02T10:23:04.000000Z","update_time":"2022-03-02T10:23:04.000000Z","remarks":null,"title":"English New Release","directory_fk":23,"sort":0,"update_by":null,"created_by":null,"music_lists_one_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/509984/0//69270deb969084ed4d43bb2b043447b9_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","directory_fk_text":"New Releases 2022"},{"id":47,"created_time":"2022-03-02T10:26:41.000000Z","update_time":"2022-03-02T10:26:41.000000Z","remarks":null,"title":"Chinese New Release","directory_fk":23,"sort":0,"update_by":null,"created_by":null,"music_lists_one_image":"https://picsum.photos/500/500","directory_fk_text":"New Releases 2022"},{"id":48,"created_time":"2022-03-02T10:27:44.000000Z","update_time":"2022-03-24T06:59:02.000000Z","remarks":null,"title":"Cantonese New Release","directory_fk":23,"sort":0,"update_by":null,"created_by":null,"music_lists_one_image":"https://image.super-server.co/dev/images/albums/development/a42c1594763cad0d0ad7cce604170c34/500618/500612//773913ece55a033c4ce6d810cfd8bc41_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","directory_fk_text":"New Releases 2022"}]},{"id":24,"title":"Age","update_by":null,"created_by":null,"status_text":"online","get_app_main_page_lists":[{"id":49,"created_time":"2022-03-02T10:28:54.000000Z","update_time":"2022-03-02T10:28:54.000000Z","remarks":null,"title":"2021","directory_fk":24,"sort":0,"update_by":null,"created_by":null,"music_lists_one_image":"https://placeimg.com/500/500/tree","directory_fk_text":"Age"},{"id":50,"created_time":"2022-03-02T10:29:40.000000Z","update_time":"2022-03-02T10:29:40.000000Z","remarks":null,"title":"2020","directory_fk":24,"sort":0,"update_by":null,"created_by":null,"music_lists_one_image":"https://picsum.photos/500/500","directory_fk_text":"Age"},{"id":51,"created_time":"2022-03-02T10:30:55.000000Z","update_time":"2022-03-02T10:30:55.000000Z","remarks":null,"title":"90\'s","directory_fk":24,"sort":0,"update_by":null,"created_by":null,"music_lists_one_image":"https://picsum.photos/500/500","directory_fk_text":"Age"},{"id":52,"created_time":"2022-03-02T10:31:41.000000Z","update_time":"2022-03-02T10:31:41.000000Z","remarks":null,"title":"80\'s","directory_fk":24,"sort":0,"update_by":null,"created_by":null,"music_lists_one_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/500103/0//61ccfb1834dcbd071de5b64c8ebf3b43_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","directory_fk_text":"Age"},{"id":59,"created_time":"2022-04-05T03:57:30.000000Z","update_time":"2022-04-05T03:57:30.000000Z","remarks":null,"title":"a","directory_fk":24,"sort":0,"update_by":"os","created_by":"os","music_lists_one_image":null,"directory_fk_text":"Age"}]},{"id":26,"title":"test","update_by":null,"created_by":null,"status_text":"online","get_app_main_page_lists":[{"id":58,"created_time":"2022-04-02T03:59:46.000000Z","update_time":"2022-04-02T03:59:46.000000Z","remarks":null,"title":"test release","directory_fk":26,"sort":0,"update_by":"os","created_by":"os","music_lists_one_image":"https://image.super-server.co/dev/images/albums/development/a42c1594763cad0d0ad7cce604170c34/500024/500018//b863856e9ea0384352d143b81ac09505_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","directory_fk_text":"test"}]},{"id":27,"title":"test2","update_by":null,"created_by":null,"status_text":"online","get_app_main_page_lists":[]},{"id":29,"title":"teststt","update_by":null,"created_by":null,"status_text":"online","get_app_main_page_lists":[]},{"id":33,"title":"21a3sd3sa12d31a","update_by":"os","created_by":"os","status_text":"online","get_app_main_page_lists":[]}]},{"title":"Recommended Artist","type":"recommended_artist","contents":[{"singerName":"Body (Remix) [feat. ArrDee, E1 (3x3), ZT (3x3), Bugzy Malone, Buni, Fivio Foreign & Darkoo]","singer_num":536415,"singer_image":"https://picsum.photos/500/500","parentId":0},{"singerName":"譚詠麟","singer_num":500018,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34//a1cbe9f1665fd73d7fe5300e0587a17d_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","parentId":0},{"singerName":"劉德華","singer_num":500093,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/500093/0//c83128f371ae5a0199371047fda7f371_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","parentId":0},{"singerName":"李克勤","singer_num":500103,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/500103/0//61ccfb1834dcbd071de5b64c8ebf3b43_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","parentId":0},{"singerName":"胡鴻鈞","singer_num":500115,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/500115/0//7fd882c0cdc8b4bfd17b75f2207bab92_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","parentId":0},{"singerName":"古巨基","singer_num":500143,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/500143/0//36fd07fed8611a4d23a6809eb524c9ad_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","parentId":0},{"singerName":"周柏豪","singer_num":500306,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/500306/0//c9f2001c21a00832d2106796cf6d393a_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","parentId":0},{"singerName":"陳百強","singer_num":500445,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/500445/0//a72a2809d9c56faec27f6bb9cfd199fa_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","parentId":0},{"singerName":"陳柏宇","singer_num":500548,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/500548/0//5a775ab9931880cde2c084a2c79b5de4_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","parentId":0},{"singerName":"謝霆鋒","singer_num":500612,"singer_image":"https://image.super-server.co/dev/images/singers/development/a42c1594763cad0d0ad7cce604170c34/500612/0//33cb3c064d70f1e09b42491c1345a780_500x500.jpg?v=6f236a8e499aafe4b0b05ac4907c947d","parentId":0}]}]}}';

class _MyHomePageState extends State<MyHomePage> {
  final TextEditingController _controller = TextEditingController()..text = _json;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text(widget.title)),
      body: Column(
        children: [
          Row(
            crossAxisAlignment: CrossAxisAlignment.center,
            children: [
              Expanded(
                child: TextField(
                  controller: _controller,
                  decoration: const InputDecoration(labelText: "Please input the json text!"),
                ),
              ),
              TextButton(onPressed: () => _controller.clear(), child: const Text("Clear")),
              TextButton(onPressed: () => setState(() {}), child: const Text("Format")),
            ],
          ),
          Expanded(
            child: SingleChildScrollView(
              child: SelectionArea(
                child: JsonShrinkWidget(
                  json: _controller.text,
                  style: const JsonShrinkStyle.light(),
                  urlSpanBuilder: (String url, JsonShrinkStyle style) {
                    if (isImageUrl(url)) {
                      return WidgetSpan(child: ExtendedImage.network(url, width: 30, height: 30, fit: BoxFit.cover));
                    }
                    return TextSpan(text: "\"$url\"", style: style.urlStyle);
                  },
                ),
              ),
            ),
          ),
        ],
      ),
    );
  }

  bool isImageUrl(String url) {
    String finalUrl = url.toLowerCase();
    return finalUrl.contains(".jpg") ||
        finalUrl.contains('.png') ||
        finalUrl.contains(".jpeg") ||
        finalUrl.contains(".webp");
  }
}
